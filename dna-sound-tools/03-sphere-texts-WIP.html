<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Codons in space</title>
  <style>
    body, * { margin: 0; font-size: 0; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js" integrity="sha512-WJXVjqeINVpi5XXJ2jn0BSCfp0y80IKrYh731gLRnkAS9TKc5KNt/OfLtu+fCueqdWniouJ1ubM+VI/hbo7POQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="lib/MidiWriterJS-master/browser/midiwriter.js"></script>
</head>
<body>
<script>

var sequence = "GACAGAACGAGGAGTAATGGTCTAAGTGCAATGCGGGAGGTTTAGATTGGGATATTAGGAAAAACTTTTTCACTAAGAGGGTGGTGAAACACTGGAATGCGTTACCTAAGGAGTCCGGTACGAGAATCTCCTTCCTTAGAGGTTTTTAAGGTCAGGCTTGACAAAGCCCGGATGGTGGATGATTTAACTGGGAATTGGTCTGCTTCGAGCAGGGGGTTGGACTAGGAGACCTTCTGGGGTCCCTTCCAACCCTGATATTCTATGATTCTATAAGAGCTGGACACCTTAACCCAATGTTGTCTTCTCCATTTGTTGTTCACACATACCAAAACTGGTGGAGAACCCGTGCATAATAAGCCCACCTCACCTAACACAGCAAAGTCCACATCCCATTGAGAGAAGTGCACTAAAAGCTCTAACTTAACACTTACCTCATGGACGCAACAGCTCTCTGCTCCACTGGACAATGTAGACAAAACAGCTGCGCTTGCCCCAGCCTATTCCTCGGTTCGGACTCCAATCCCCTGTGGCACACAAACAATAATGCCACATTATTGCTAAAATGCCACAATGGCACAATACCACATTCCCATGCTAACTGACCTATTCAACACCCCAAAAAAAGCCCTGACACATTCATACCCACAATGAAGGAGCAACCAACTACTTCTATACAGTTAAAATGAAGAGGCAACATACTCAAAAATTACACAATACTCATGGCCTTTTCCCACCCTGACTGTGGCCCATCACTAACTACAATGCTCACATCCTCCTGAGGAAACCAACACCCAGTAGAGGACAGACAAACAAGGTAGTGGTGACTAGTGATGCAAACCCAGTGCTGTGTAAGAGAGAAGAACAGAGAACGGAGCATTTCTAGTTACAGACAGGTCACTCTGCCAGCAATCGACCTTCCTCCACAGAGAACACACCCTCCGTACAATGAGCTCCCTCCCACACCAGTTAAGAACTAGCAGAGTTTGCAGGACTTCTGTCCCTAAACAAGAAGCCTCAACAGCACAAAACTTCTGACTATCGAACCCTTCAGGAGAGACTTAACTTTGACAGCTGCTGCTGCTCTCAAGATCTTCTTGTCCTTTGTACAGGGGCCTTTGCTCCCATACGTTGACAGCCATACAGCGATGTTGTGACACAGTCACAGAGAAGTAGTCACGACTCTCCACGGAACAACACAGTACCGGATCTGGACACGTCTGCAAAGACGAACAAAGCTGGACTGCAAACCGATTCACAAAGTGCCCAACTACACAATATGAAACATGACCTCACCTGCATACTGCCTCCTGAAGAGAAGGAACGCCTACTACACATTACACCCCCCTCAGAGAAGCGCCCCTCCACCCTAAACACTCTCATCCACATACTGGTGGCCCTCCACATGTCCCACCACATTGGGACCCATCGCTAACTAGAATGCTCACATCCTCCTCGGAAAACCACCACCACGTAGAGGAGAACACAAGGTGGAAGCAGTGACCTGTGATGCAAACCCAGTGCTGCGTACGAGAGAAGAACTGAGAACGGAGCATCTCTAGTTATGGACAGGTCATTCTGCCAGCAATCGACCTTCCCTCAGGGGAAACACACACTCCCTCCATACAATGAGATTCCTCCCATGCCAGTAAAGAACTAGCAGAGTTTACAGGACTTCTGTCCCTAAACAAGAAGCCTCAACGGCACAAATACTTCTGACTATCGAACCCTTCAGCAGAGACTTAACTTTGACAGCCGCTCCCGCTCTCAAGATCTTCTGGCCCTTTGTACACAGGCCTTCGCTCCCATACACTGATGTGACAGTCAGAGAAGTAGTCATGACCCTCCACAGAACAACGTGACACGGTACCGATCTGGACGTGTCTGCAAATACAAACAAAGCATCACTGCAAACCTACTCACAAAGCACCCAACTACACAATCTGAAACATGACCTCACCTGCATACTGCTTCCTGAAGAGAAGGCACACCTACTAAACATTACACCGCCCCGAGAGAAGCACCACCCACCCCAAACACAGTCATCCACATATTGGTGGCCCTCCCCATGTCCCAACACAACAGGGGCCCATCGCTAACTAGGATGCTCCCATCCTCCTCAGAAAACAACACCCAATAGAAAAGAAAAGGATGAAGCGGTGACCTGTGATGCAAACCCAGTGCTGTGTAAGAGAGGCATCTGAGAACGGAGCATCTCTAGTTACAGAGAGGATAATCTGCCAGCAATCAACCTTCCTCCAGCAGAAACACACACTCCCTCCATACGACGATCTCCTGCCCACCCCTCACACGCCCATTAAGAATGGGCAGAGTTTAGAGGACTCCTACCCGTAAATAAGAAGCTTCAACAGCACGAATACTTCTGACCATCAAACCCTTCAGCAGATTCTTATTTCACCAGGATGGGCTGCAATGGTGTCCCTAGCCTCTGTTTGCCGGAAGCTGCAATCAGGTGACGGGATGGATCACTTGATGATAACCTGTCCGTTCATTCCCTTTGGAGCACCTGCCATTGGCCGCTGTCAGAGGACAGAATACTGGGCTTGATGGACCTTTGGTCTGACCCACTATGGCCATTCTTACATACCCAACTTTGACAGCCACTCCCAAGATCTTCTTTTCCTTTGTACACGGGCCTTTGCTCCCATACATCAGCATCCATCTGGCACCAATGCACAGCTATGCCATGACAGAACTAGTCACGACCCTCCACAGAACGAGGTGACACGGTACTGGATGTGGAAGCATCTGCAAATACAAACAAAGCTTGACCAAAAACCTACTCGCAAAGCTCCCAGATACACGATAGAAAAGATGACCCCACCTACATACTGCTTCCTGAAGAGAAGGAACACCTACATATTATACCCCTCAAGAGAAGCACCCACCCTCCTCAAACACGCTCATCCACATATTGGTGGCCCTCCACATGTCCCACCACAACAGGGGCCCATCACTAACTAGGATGCTCACATCCTCCTCGGAAAACCAGCACCATGTAGAGGAGAACACAAGGTGGAAGGGGTGACCTGTGATGCAAACCCAGTGCTGCGTACGAGAGAAGAACTGAGAACGGAGCATCTCTAGTTACAGACAGGTCACTCTGCCAGCAACGACCTTCCCTCAGGGAAACGCACACTCTCTCCATACAACATGCCCACCCGCCACACCAATTCAGAATGGGGATAGTTTAGAGGACTCCCGCCTCTAAACAATGAGCCTCAATGGCTCAAATACTTCTGGCTATCAAACCTTCAGCAGAGACTTAACTTTGACAGCCACTCCCGCTCTCAAGATCTTCTTGTCCTTTGTACGTGGGGCTTCGCTCCCATACATTGACAGCCGTACAGCGATGTCGTGACACAGTCACAGAGAAGTAGTCACAACCCTCCACGGAACAACACGGTACCAGATCTGGACACATCTGCAAAGATGAACAAAGCTGGACTGCGAACCAACTCACAAAGCACCCAACTACAATATGAAACATGACCTCACCTGCATACTGCTTCCTGAAGAGAAAGACACCTACTACACATTACACCCCCCTCAGAGAAGCACCCCCCGACCCTAAACACTCTCATCCACATACTGGTGGCCCTCCCTGTGTCCCACCACAACTGGGACCCATCGCTAACTAGGATGCTCTCATCCTCCTCCAAAAACCACCACCACGTAGAGGAGAACACAAAATGGAAGCAGTGACCTGTGATGCAAACCCAGTGCTGCATACAAGAGAAGAACTGAGAACGGAGCATCTCTAGTTACAGACAGGTCACTCTGCCAGCAATCCCTTCCCTCGGGGGAAACGCACGCTCCCTCCGTACATAGAGCCCCCCACCCCTCACGTGCCCATTCAGAATGGGGAGAGTTTAGAGGACTCCCGCCCCTAAACAAGGAGCCTCAATGGCTCAAATACTTCTGACTATCGAACCCTTCAGCAGAGACTTAACTTTGATAGCCACTGCCGCTCTCAAGATCTTCTTGTCCTTTGTACACGGGCCTTCGCTCCCATATGTTGACAGCCGTACAGCGATGTTGTGACAATCAAAGAGAAGTAATCACGACCCTCCACGGAATGAGACTACTCGGTACTGGATCTGGACACATTTGAAAATAAAAACAAAGCTTTTGCAAACCTCAGTTATAAACTCTACTCACAAAGCTCCCAACACTACAATATGAAAGATGACCTCACCTACATACCGATTCCTTGAGAGGGAACAGCTACTACATATTACACCCCCACATGGAACACTCTCATCCACATGGAAAATGGCTACGCTTCTACATAGTGGTGGCTCTCCCCCTTTCCCTACACCACAGGGGCCCATCGGTAACTAGGATGCTCACATCCTCCTCGGAAAACCACCACCGTGTAGAGGAAAACGCAAGGTGGAAGCGGTGACCTGTCATGCCAACCCAGTGCTGCGTAAGAGAGAAGAACTTAGAACGGAGCATCTCTAGTTACAGACAAGTCACTCTGCCAGCACGCTCAGGGGAAACGTACTGCTCCATCCATACAATGAGCTCCCGCCCACCCCTCACAGGTCCAGTAAGAATGAGCAGAGTTTAGAGGACTCCCATAAGTAAAGAAAGAGCCTCAACATCAGAAACGCTTCTGACCATCGAACACTTTGGCATATACTTATCTTTAGAAATTGGACAGGTGCTCTCCCTCTTGAGATCTCCTTCACCTCGGTAGACAGGCCTTAATTCCCATATGTTGAAATTGCTTACAAAATACAGCAATTGTGTGACAGACAAAGAGAAAAATATTCACAACCTTCACGTCACAATGCGACTCAGTACCGGATCTGGAAGCAGCTGCAAATACAAAGAAAGCTTGACTGCAAACATGGTTTATAAACTCTACTCACAGGATTCCAGACAACTGAGTAGGAGAAAATACAGGAAGAGAATGCAGTTGAGGTTAAGAGAAGAAACTCTTACTAAATACTACAGTCTTCTCAGACCAGCTCCTAACCCAGACAGGAAACTTCTATGCTTCTACAACAGTCCAACACAATGGACACACTACCAATACCAGATGTGTGTTTAATAGAATCTCTGTCGGAAACAACCTCCAATGTCTTCCCTCCTAATGAAAATACAAATGATAACACATGAATCAAACACCCTATGAACAACCTGAAATGAAAGAAAACCACATTACACAAAAATAAGCACAGAAAAATAGTACACTAACACAAATACATGTCATCATTACCTCATATTAATGCTCACCGTGGCCATAAACACCCCTACAAGTGCCTATGCACATCTCTTTGAACCAACACAAAGTCGAATGACTTACTGTGACAAGACCCCAGCTTATATACTGCCTAAGCTCCACCCCTCCATTTCCCAGCATGCTTTAGAAGCCAAAGGCAGCTATAAATACAGACTCAGGCAACACAGAAACCCTTTAGTTCATGCCTAGCTTAGCAGTGGCAAGCACTGTTCATCTTGATGTATTAATCAGCCTTCCTTCTTACAATACAAATTTGCAGAAGACTTAAACTCTATCACCAGGTAACACTATAATTACCATGTTTCAGTTTCCTAAAAAGAAAATACTACCTAGAGAGAAGAGGGGACTCCACAGTAGGTCCAGTTGGGGGCTGCTGAAAGAAGTACCTCAACGGTGCTGGCGGGGTGCATTTGTACTGTGAGAGGGTATTTAGGGGTAATGGAAAGATTATTTAGCTGATGCTTGAGGGCATACCACAGCCTCAAGCTCAAAATGGAGGGCAGTGTCACTCCCTGACACGCTGCCCAGGCAGCTGCCACAAGCCAGAGAAACTGCACCATCCCCATGACCAACTTTAGGGAAAATGGCAACCTGTGCAAACTTGTACTTTGCCCTGAGCTACCTCCCCCCATCCCCTGCACACCCCACTGCCTCCTCCAAGTGCTTAATTTATCTAGACAAAGGTCACAGAGCTCAGGCCCGGCATAAATTAAGCACTGTATGGGCAGCTAGAGAGCACTGGCTGCCAGGTAGGCACCCGGCTCTTAAGGCAACACCACAACCTGCAGCAGAATCACAGACGTAAGGGTCGCGTAGTGTATTGCCACCCTGATGCCACCATTGCTGCTGCAGCTTGTGATTCCTGGCACTCAGCATGCAGCTCAAGGTGGACTTCGTGCTGTCACACAGGGGGCTGCATCTTGCCAGAGCCCACAGCCCTCTGGCCACTCCCAGCTCACCAGAGGCAACGTTTATATTTGGGGGGGTAAGGCAATTTTAATCATGATTCCAGGGGCTATTTGAGCACCTGAAAACTCCAGGTTTCTTGCACATGATAACTTAGATATAGTACTCCTGTCAGCTAAATCCTAATTCTTATATATATAGGAAAAAATATAAACTGAAAATGTGGCTTTAGTTGGAGTTTGTATATATGTATGTTTAGAACAATCAGGAGACAATACAGCAAGACAGTCCCACTCCCAAGCCTGAAGGTGTCAGTTCTAGAGCTTTAACACGATACCAGAAACACACATTTGCTATTTTGTACATTATCTTTAGTACAGATATATACAAAGTGAGCAAATAAGCACATTTTAAGCAGAGTTTATTTAACACACACTCTGTGTTACTACCATTATCTACTCAAAATTAAGTAAATGCTTTTTAGTGGAGTGAAAAACAATTCACTAAAATAAACATACATGATTGATGTGGTGTTTTCTCTTTTATTAAGAAAGGAAATTCATTTCTCTAAATATTTTTGCATTTATGTTTACCAATCGATCAAAATCATGTACATGACTCACTAAGTTTGACAGGTTTCAGAGTAGCAGCTGTTAGTCTGTATCCGTAGAAAGAAAAGGGGTACTTGTGGCACCTTAGCGACTAACAAATTTATTTGAGCGTAAGCTTTCATGAGCTACAGTTTATGCTCAAATAAATTTTTTAGTCTCTAAGGTGCCACAAGTACTCCTTTTCTTTTTACTAACATTTGAGTCCATCATGGTTATTAGTATCGTACATGTAACCACATTTATTTTCATACAAATGTTAACTTATTTTACAGAGATCACTAAAAATACGATTTGAAAATAAGCGACCTTCAGCTGTAGTGGCTACAGTTGTGAGTAGATGCAGAATTTATGTTCTAGCAGGATACTATTATTTGATTGTCTGACTTTTATCATATTGTGCTTTATCATTGTTATTTTAAATAATTAATGAAAATTAAGCAATTACAATTACCAGCCAGGACAGGTTAGGCATTTTAGAACTCATTTCTACCTTAAATTTAATTATTTGAGTAGTAAAATTATGAAATGCACAGACCACAGAAAAAATAAACAACCAGCACTGTAACCCTTAAACTTTGAAATGCGCCATGCACATATAGTCTCTGCAATTTTATTCTTTCAAAGGAAGTAATAACAACAACAACAGTACAAGTGTGTATGTGAGAGAGAGGCTGTGTGTATTTGGAGAGTGAGAGACAGCACACTCTTACTTTAAGCGGAGACCTCACTAATCAGAAGGCTTGTTCAGTCCAGCAGCAGAACTCAGCATCTCCCACTCAGGACCCAGAGGCAACAGCACAAACTCCTCAATCCCCCTACCCAAGCTCAGCAGAGACCAGATACAAAGACGGGAGATTGTGACACCCCAGCATCAGCCTCTGCAGAGCGGACAAGATGTTCCCAGGACCAGCTTGGCCAAGGGTTGCTCCAAGTGTGGGTAGGGGGCAAGAGCAGGGACACTGAAACAGAGGGCACCAGGGAGCCATGCCCCATTACTTTTAATATTACTTTCTACAAGCCATAAGGGGAAGAAACACCTGTGTTTCTCGACAGGACAGTATTCAGGGCACACCTCATGTTCCCATGAGGAGTACTATCGATGACACACCTCTTGTTTCCAGAGGGGACAGTATTCAGGACACACTCCTTGTTCCCAGGAGGAGTGCTATTGTTGATACACCTCTTGTTACTGGCTCGGGGTAGGGGCAGTATTCATGTCACACCTGTTATTTCCAGAGGGGACACTTTTCAGCACACACCCCTTGTTCCCAGGAGGAGTGCTATTGATGACACACCTCTTGTTTCGGGGGGGGGGCAGTATTCGGTACACACCCTTGTTTCCAACAGGACTACAATTCATGACATACTCCTTGTTTCTGGATGGGGCAGTATTCAGCAGACACCTCTTACTTCCAGAGGACACAGTATTCAAGACACACTCCTTGTTTCCAGAGAACATTGTACTCATAATATACTCTTCTTCCCAAAAGGAACGGTGTTCAGGACACACCTCTTGTTCCCAGGGGGAGTACTATTGATGACAAACTCTTGTTTCCAGAGGGGACAGTATTCAGGACACACCCCTTGTTTCCAAAGGGGGACACACCTCTTGTTCCCACTAGGAGTACTAATGATGACACACCCCTTATTTCCTGGAGTACCACCAATGATGACACACCCTTGTTCCCAGGAGGAGTACTATTGATGACACACATCTTGTTTCCCGAGGAGACAGTATTCATGGCACACTTCTTGTTTCTGGAGGACACTGTACTCATAACACATCTTTTGTTGCCAGAAAGGACAGTATGCTGGACATAGCTCTCGTTCTCAGGAGGACTATTAATGACTCACCCCTTCTTTTTACAGGGGACACTATTCGAGACTCACCCCTTCTTTCTGCAGGGGACACTATTCAGGATAAACCCCTTATTCCTAGAGGGGACTGTATTCAGAACACACCTCTCCTCTCTGGAGGGAACAGTCTTCGGAACATACTTCTTGGTCTCTGTGGGGACAGTATTCGTGACACACCACTTGTTTTTATGAGAAGTATTATTGATAAAACACCCCTTCTTTCTGTGGGGGGACAGTATTTGTA";

var seq = sequence.split("");
var codons = [];
while (seq.length > 3) {
  codons.push(seq.splice(0, 3).join(""));
}
console.log(codons)
var cols = 30;
var rows = 48;
var redLow, redHigh;
var ps = new ParticleSystem();

function setup () {
  createCanvas(windowWidth, windowHeight/*, WEBGL*/);

  redLow = color(158, 76, 76);
  redHigh = color(255, 66, 66);

  noStroke();
  rectMode(CENTER);
  textAlign(CENTER, CENTER);
  textFont("Courier");
  textSize(15);
  // frameRate(5);

  var index = 0;
  for (var col = 0; col < cols; col++) {
    for (var row = 0; row < rows; row++) {
      var x = width/cols*col + width/cols/2;
      var y = height/rows*row + height/rows/2;
      var c = new CodonInSpace(codons[index], x, y);
      ps.addParticle(c);
      index++;
    }
  }
  // debugger
}

function draw () {
  background(0);
  ps.run();
  // var index = 0;
  // for (var col = 0; col < cols; col++) {
  //   for (var row = 0; row < rows; row++) {
  //     var x = width/cols*col + width/cols/2;
  //     var y = height/rows*row + height/rows/2;
  //     text(codons[index], x, y);
  //     index++;
  //   }
  // }
}


// ------------------------
// Particle class
// ------------------------
function CodonInSpace (triplet, x, y) {
  this.triplet = triplet;
  this.originalPosition = createVector(x, y);
  this.position = createVector(x, y);
  this.acceleration = createVector(0, 0);
  this.velocity = createVector(random(-0.3, 0.3), random(-0.3, 0.3));
  this.arranging = false;
  this.color = redLow;
  this.colorRe = color(255, 0, 0);

  this.run = function () {
    this.update();
    this.display();
  }

  this.update = function () {
    if (this.arranging) {
    
      var toOriginalPosition = p5.Vector.sub(this.originalPosition, this.position);
      toOriginalPosition.mult(random() * 0.05);
      this.position.add(toOriginalPosition);

      // var toOriginalPosition = p5.Vector.sub(this.originalPosition, this.position);
      // toOriginalPosition.mult(random() * 0.01);
      // this.acceleration.add(toOriginalPosition);
      // this.velocity.add(this.acceleration);
      // this.velocity.mult(this.originalPosition.dist(this.position)*1);
      // this.position.add(this.velocity);
      // this.acceleration.mult(0);
    
    } else {

      this.velocity.add(this.acceleration);
      this.position.add(this.velocity);
    }
  }

  this.display = function () {
    fill(this.arranging ? this.colorRe : this.color);
    text(this.triplet, this.position.x, this.position.y);
  }

  this.rearrange = function (boo) {
    this.arranging = boo;
  }

}



// ------------------------
// Particle system class
// ------------------------

function ParticleSystem () {
  this.particles = [];
 
  this.addParticle = function (p) {
    this.particles.push(p);
  }

  // this.applyForce = function (force) {
  //   this.particles.forEach(p => {
  //     // force depends on particle position
  //     // var f = force.dist(p.position)
  //     // var f = force.dist(p.position)
  //     p.applyForce(f);
  //   });
  // }

  this.rearrange = function () {
    this.particles.forEach(p => p.rearrange());
  }

  this.run = function () {
    for (let i = this.particles.length-1; i >= 0; i--) {
      let p = this.particles[i];
      p.run();
    }
  }
}

function mousePressed () {
  ps.particles.forEach(p => p.rearrange(true));
}
function mouseReleased () {
  ps.particles.forEach(p => p.rearrange(false));
}

// function keyPressed () {
//   if (keyCode === ENTER) {
//     ps.particles.forEach(p => p.rearrange());
//   }
// }


</script>
</body>
</html>